{% macro section_header(icon_class, title) %}
<div class="flex items-center mb-4" role="heading" aria-level="2">
  <div class="w-8 h-8 flex items-center justify-center mr-3 rounded-md bg-[#21262d] border border-[#30363d] text-[#58a6ff]" aria-hidden="true">
    <i class="fas {{icon_class}}"></i>
  </div>
  <h2 class="text-xl font-semibold text-[#c9d1d9]">{{ title }}</h2>
</div>
{% endmacro %}

{% macro quota_warning(var_name='quotaRemaining') %}
<!-- Quota warning removed -->
{% endmacro %}

{% macro info_banner(icon='fa-info-circle', title='Information', body='') %}
<div class="panel p-4 mb-4" role="note" aria-label="{{ title }}">
  <div class="flex items-start gap-3">
    <div class="w-8 h-8 flex items-center justify-center rounded-md bg-[#21262d] border border-[#30363d] text-[#58a6ff]" aria-hidden="true">
      <i class="fas {{icon}}"></i>
    </div>
    <div class="text-sm">
      <h3 class="font-semibold text-[#c9d1d9] mb-1">{{ title }}</h3>
      <p class="text-[#8b949e]">{{ body }}</p>
    </div>
  </div>
</div>
{% endmacro %}

{% macro concept_modal() %}
<!-- Concept Detail Modal -->
<div x-show="conceptModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50" @click="closeConcept" style="display: none;">
  <div class="bg-[#0d1117] border border-[#30363d] rounded-xl max-w-4xl max-h-[90vh] concept-modal-content" @click.stop>
    <div class="p-6">
      <!-- Modal Header -->
      <div class="flex items-center justify-between mb-6">
        <div class="flex items-center space-x-3">
          <div class="w-10 h-10 bg-[#21262d] border border-[#30363d] rounded-lg flex items-center justify-center">
            <i class="fas fa-lightbulb text-[#58a6ff]"></i>
          </div>
          <div>
            <h3 class="text-xl font-semibold text-[#c9d1d9]" x-text="currentConcept"></h3>
            <p class="text-sm text-[#8b949e]">Deep Research Explanation</p>
          </div>
        </div>
        <button @click="closeConcept" class="text-[#8b949e] hover:text-[#c9d1d9] transition-colors">
          <i class="fas fa-times text-xl"></i>
        </button>
      </div>

      <!-- Loading State -->
      <div x-show="loadingConcept" class="text-center py-8">
        <div class="inline-flex items-center space-x-2 text-[#8b949e]">
          <div class="animate-spin rounded-full h-5 w-5 border-b-2 border-[#58a6ff]"></div>
          <span>Loading detailed explanation...</span>
        </div>
      </div>

      <!-- Content -->
      <div x-show="!loadingConcept && conceptContent" class="prose prose-invert max-w-none">
        <div x-html="conceptContent" class="text-[#c9d1d9] space-y-4"></div>
      </div>

      <!-- Error State -->
      <div x-show="!loadingConcept && conceptError" class="text-center py-8">
        <div class="text-[#f85149] mb-2">
          <i class="fas fa-exclamation-triangle text-2xl"></i>
        </div>
        <p class="text-[#f85149] mb-4" x-text="conceptError"></p>
        <button @click="loadConcept(currentConcept)" class="btn btn-secondary">
          <i class="fas fa-redo mr-2"></i>Try Again
        </button>
      </div>

      <!-- Footer -->
      <div x-show="!loadingConcept && conceptContent" class="mt-6 pt-4 border-t border-[#30363d] flex items-center justify-between text-sm text-[#8b949e]">
        <div class="flex items-center space-x-2">
          <i class="fas fa-brain text-[#58a6ff]"></i>
          <span>Generated by Gemini Deep Research</span>
        </div>
        <button @click="closeConcept" class="btn btn-secondary">Close</button>
      </div>
    </div>
  </div>
</div>
{% endmacro %}

<style>.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}</style>